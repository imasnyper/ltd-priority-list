{% extends "list/base.html" %}

{% block body %}
    {#    <div class="uk-container">#}
    <div class="uk-grid-small uk-grid-match" uk-grid>
        {% for machine in machines %}
            {#            {% if forloop.counter|divisibleby:2 %}#}
            {#                </div>#}
            {#                <div class=uk-child-width-expand@s" uk-grid>#}
            {#            {% endif %}#}
            <div class="uk-width-1-2">
                <div class="uk-card uk-card-default uk-card-body">
                    <div class="uk-card-title">
                        <h3>{{ machine.name }}</h3>
                    </div>
                    {% with job_set=machine.active_jobs %}
                        {% if job_set|length > 0 %}
                            <table class="uk-table-small uk-table-divider uk-table-hover uk-table-middle">
                                <thead>
                                <tr>
                                    <th></th>
                                    <th class="uk-table-shrink uk-text-nowrap">Job #</th>
                                    <th>Description</th>
                                        <th>Customer</th>
                                    <th>Tools?</th>
                                    <th colspan="4">Edit/Delete</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for job in job_set %}
                                    <tr class="job-row">
                                        <td class="uk-table-link uk-text-bold">
                                            <a href="{% url 'list:job-detail' job.pk %}" class="uk-link-reset">
                                                {{ forloop.counter }}.
                                            </a>
                                        </td>
                                        <td class="uk-table-link">
                                            <a href="{% url 'list:job-detail' job.pk %}" class="uk-link-reset">
                                                {{ job.job_number }}
                                            </a>
                                        </td>
                                        <td class="uk-table-link">
                                            <a href="{% url 'list:job-detail' job.pk %}" class="uk-link-reset">
                                                {{ job.description|title }}
                                            </a>
                                        </td>
                                        <td class="uk-table-link">
                                            <a href="{% url 'list:job-detail' job.pk %}" class="uk-link-reset">
                                                {{ job.customer.name|title }}
                                            </a>
                                        </td>
                                        <td class="uk-table-link uk-text-center">
                                            {% if job.add_tools %}
                                                <a href="{% url 'list:job-detail' job.pk %}" class="uk-link-reset">
                                                    &#10004;
                                                </a>
                                            {% else %}
                                                <a href="{% url 'list:job-detail' job.pk %}" class="uk-link-reset">
                                                    &#10006;
                                                </a>
                                            {% endif %}
                                        </td>
                                        <td>
                                            <form action="{% url 'list:archive' job.pk %}" class="delete-form"
                                                  method="post">
                                                {% csrf_token %}
                                                <button type="submit" class="delete-button"></button>
                                            </form>
                                        </td>
                                        <td>
                                            <a href="{% url 'list:edit' job.pk %}" class="edit-link">
                                                <div class="edit-button"></div>
                                            </a>
                                        </td>
                                        <td>
                                            {% if forloop.counter > 1 %}
                                                <a href="{% url 'list:sort_up' job.pk %}" class="sort-up-link">
                                                    <div class="sort-up-button"></div>
                                                </a>
                                            {% else %}
                                                <div class="sort-up-link">
                                                    <div class="sort-up-button-placeholder"></div>
                                                </div>
                                            {% endif %}
                                        </td>
                                        <td>
                                            {% if forloop.counter < job_set|length %}
                                                <a href="{% url 'list:sort_down' job.pk %}" class="sort-down-link">
                                                    <div class="sort-down-button"></div>
                                                </a>
                                            {% endif %}
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        {% else %}
                            <p class="empty-job-list">Currently no jobs for {{ machine.name|title }}</p>
                        {% endif %}
                    {% endwith %}
                    <form class="add-job-form" action="{% url 'list:add' machine.pk %}" method="post">
                        {% csrf_token %}
                        {{ form.non_field_errors }}
                        <div class="form-job-number">
                            {{ form.job_number.errors }}
                            <span class="job-number-label">{{ form.job_number.label_tag }}</span>
                            <span class="job-number-input">{{ form.job_number }}</span>
                        </div>
                        <div class="form-description">
                            {{ form.description.errors }}
                            <span class="description-label">{{ form.description.label_tag }}</span>
                            <span class="description-input">{{ form.description }}</span>
                        </div>
                        <div class="form-customer">
                            {{ form.customer.errors }}
                            <span class="customer-label">{{ form.customer.label_tag }}</span>
                            <div class="input-field customer-input">{{ form.customer }}</div>
                        </div>
                        <div class="form-due-date">
                            {{ form.due_date.errors }}
                            <span class="due-date-label">{{ form.due_date.label_tag }}</span>
                            <span class="due-date-input">{{ form.due_date }}</span>
                        </div>
                        <div class="form-add-tools">
                            {{ form.add_tools.errors }}
                            <span class="add-tools-label">{{ form.add_tools.label_tag }}</span>
                            <span class="add-tools-input">{{ form.add_tools }}</span>
                        </div>
                        <button type="submit">Save</button>
                    </form>
                </div>
            </div>
        {% endfor %}
    </div>
    {#    </div>#}
{% endblock body %}
{% block login %}{% endblock login %}